<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<title></title>
		<link href="../../lib/mui/css/mui.min.css" rel="stylesheet" />
		<link href="../../lib/mui/css/mui-icons-extra.css" rel="stylesheet" />
		<style>
			.mui-slider {
				height: 12em;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<span id="scan" class="mui-pull-left mui-icon mui-icon-extra mui-icon-extra-sweep"></span>
			<h1 class="mui-title">西郊国际移动交易</h1>
			<span id='setting' class="mui-pull-right  mui-icon mui-icon-settings"></span>
		</header>
		<div class="mui-content">
			<div id="slider" class="mui-slider">
				<div class="mui-slider-group mui-slider-loop">
					<!-- 额外增加的一个节点(循环轮播：第一个节点是最后一张轮播) -->
					<div class="mui-slider-item mui-slider-item-duplicate">
						<a href="#">
							<img src="../../images/slider/slider-img-3.jpg">
						</a>
					</div>
					<!-- 第一张 -->
					<div class="mui-slider-item">
						<a href="#">
							<img src="../../images/slider/slider-img-1.jpg">
						</a>
					</div>
					<!-- 第二张 -->
					<div class="mui-slider-item">
						<a href="#">
							<img src="../../images/slider/slider-img-2.jpg">
						</a>
					</div>
					<!-- 第三张 -->
					<div class="mui-slider-item">
						<a href="#">
							<img src="../../images/slider/slider-img-3.jpg">
						</a>
					</div>
					<!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
					<div class="mui-slider-item mui-slider-item-duplicate">
						<a href="#">
							<img src="../../images/slider/slider-img-1.jpg">
						</a>
					</div>
				</div>
				<div class="mui-slider-indicator">
					<div class="mui-indicator mui-active"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
				</div>
			</div>
			<ul class="mui-table-view mui-grid-view mui-grid-9">
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="../module/recharge.html" id="aRecharge">
						<span class="mui-icon mui-icon-extra mui-icon-extra-gold"></span>
						<div class="mui-media-body">圈存</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="../module/withdrawal.html" id="aWithdrawal">
						<span class="mui-icon mui-icon-extra mui-icon-extra-card">
		                    <div class="mui-media-body">圈提</div>
					</a>
				</li>
		        <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        	<a href="../module/bocservice.html" id="aBank">
		                <span class="mui-icon mui-icon-extra mui-icon-extra-hotel"></span>
						<div class="mui-media-body">中国银行</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="#" id="aParking">
						<span class="mui-icon mui-icon-map"></span>
						<div class="mui-media-body">停车</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="#" id="aRepast">
						<span class="mui-icon mui-icon-extra mui-icon-extra-cold"></span>
						<div class="mui-media-body">就餐</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="#" id="aTransfer">
						<span class="mui-icon mui-icon-extra mui-icon-extra-peoples"></span>
						<div class="mui-media-body">转账</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="#" id="aGoods">
						<span class="mui-icon mui-icon-extra mui-icon-extra-express"></span>
						<div class="mui-media-body">货物登记</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="#" id="aDetail">
						<span class="mui-icon mui-icon-extra mui-icon-extra-prech"></span>
						<div class="mui-media-body">明细</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
					<a href="#" id="aMore">
						<span class="mui-icon mui-icon-more"></span>
						<div class="mui-media-body">更多</div>
					</a>
				</li>
			</ul>
			<div class="mui-content-padded">
				<!--<p> 您好 <span id='account'></span>，您已成功登录。 </p>-->
				<p>&nbsp;</p>
			</div>
		</div>

		<nav class="mui-bar mui-bar-tab">
			<a class="mui-tab-item mui-active" id="tpHome">
				<span class="mui-icon mui-icon-home"></span>
				<span class="mui-tab-label">首页</span>
			</a>
			<a class="mui-tab-item" id="tpPerson" href="../module/person.html">
				<span class="mui-icon mui-icon-contact mui-icon-icon-contact"></span>
				<span class="mui-tab-label">我的</span>
			</a>
			<a class="mui-tab-item" id="tpWebsite">
				<span class="mui-icon mui-icon-extra mui-icon-extra-hotel"></span>
				<span class="mui-tab-label">网站</span>
			</a>
			<!--<a class="mui-tab-item">
		        <span class="mui-icon mui-icon-email"></span>
		        <span class="mui-tab-label">通知</span>
		    </a>-->
			<a class="mui-tab-item" id="tpAbout">
				<span class="mui-icon mui-icon-info"></span>
				<span class="mui-tab-label">关于</span>
			</a>

		</nav>
		</div>
		<script src="../../lib/mui/js/mui.min.js"></script>
		<script src="../../js/common/common.js"></script>
		<script>
			(function($, doc) {
				$.init();
				//打开圈存界面
				function toRecharge() {
					$.openWindow({
						url: '../module/recharge.html',
						id: 'pageRecharge'
					});
				}
				//打开圈提界面
				function toWithdraw(){
					$.openWindow({
						url: '../module/withdrawal.html',
						id: 'aWithdrawal'
					});
				}
				//----------begin: 顶部标题栏-------------------
				$.plusReady(function() {
					window.addEventListener('show', function() {
						//do sth.
					}, false);

					var localSettings = common.getSettings();
					if(common.isEmptyObject(localSettings)) {
						plus.nativeUI.toast('请登录');
						$.openWindow({
							url: '../login/login.html',
							id: 'login'
						});
						return;
					}

					//设置
					var settingPage = $.preload({
						id: 'setting',
						url: '../module/setting.html'
					});
					var settingButton = doc.getElementById('setting');
					settingButton.addEventListener('tap', function(event) {
						settingPage.show();
					});
					//扫码
					var scanButton = doc.getElementById('scan');
					scanButton.addEventListener('tap', function(event) {
						$.openWindow({
							id: 'scan',
							url: '../module/barcode.html'
						});
					});
					//----------end: 顶部标题栏-------------------

					//----------begin: 轮播图片-------------------
					var gallery = mui('.mui-slider');
					gallery.slider({
						interval: 5000 //自动轮播周期，若为0则不自动播放，默认为0；
					});
					//----------end: 轮播图片-------------------

					//----------begin: 九宫格菜单-------------------
					var pageWidthdrawal = $.preload({
						"id": 'pageWidthdrawal',
						"url": '../module/withdrawal.html'
					});
					var pageBank = $.preload({
						"id": 'pageBank',
						"url": '../module/bank.html'
					});

					$('.mui-table-view-cell').on('tap', 'a', function() {
						var title = doc.querySelector('.mui-title');
						var id = this.getAttribute('id');
						switch(id) {
							case 'aRecharge': //圈存
								//验证会员是否有绑定的圈存银行卡
								common.postJSON(common.getServiceUrl('getFirstMemberBankcard'), {
									access_token: localSettings.access_token,
									memberInfoId: localSettings.member_pk,
									isRecharge: 1
								}, function(result) {
									if(result.success) {
										if(result.code == 'yes') {
											//去圈存
											toRecharge();
										} else {
											plus.nativeUI.toast('请先绑定用于圈存的银行卡');
											//去绑定圈存
											$.openWindow({
												url: '../module/recharge_binding.html'
											});
										}
									} else {
										plus.nativeUI.toast(result.msg);
									}
								});
								break;
							case 'aWithdrawal': //圈提
								//验证会员是否有绑定的圈提银行卡
								common.postJSON(common.getServiceUrl('getFirstMemberBankcard'), {
									access_token: localSettings.access_token,
									memberInfoId: localSettings.member_pk,
									isWithdraw: 1
								}, function(result) {
									if(result.success) {
										if(result.code == 'yes') {
											//去圈提
											toRecharge();
										} else {
											plus.nativeUI.toast('请先绑定用于圈提的银行卡');
											//去绑定圈提
											$.openWindow({
												url: '../module/bindmemberbeforewithdraw.html'
											});
										}
									} else {
										plus.nativeUI.toast(result.msg);
									}
								});
								break;
							case 'aBank': //银行
								pageBank.show();
								title.innerHTML = '中国银行增值服务';
								break;
							default:
								plus.nativeUI.toast('暂未开通！');
						}
					});
					//----------end: 九宫格菜单-------------------

					//----------begin: 底部导航栏-------------------
					var pagePerson = $.preload({
						"id": 'pagePerson',
						"url": '../module/person.html'
					});
					var pageWebsite = $.preload({
						"id": 'pageWebsite',
						"url": '../module/website.html'
					});
					var pageAbout = $.preload({
						"id": 'pageAbout',
						"url": '../module/about.html'
					});
					$('.mui-bar-tab').on('tap', 'a', function() {
						//document.location.href = this.href;
						var id = this.getAttribute('id');
						switch(id) {
							case 'tpHome':
								pagePerson.hide();
								pageWebsite.hide();
								pageAbout.hide();
								break;
							case 'tpPerson':
								pagePerson.show();
								break;
							case 'tpWebsite':
								pageWebsite.show();
								break;
							case 'tpAbout':
								pageAbout.show();
								break;
						}
					});
					//----------end: 底部导航栏---------------------

					//----------begin: 按键事件----------------
					$.oldBack = mui.back;
					var backButtonPress = 0;
					$.back = function(event) {
						backButtonPress++;
						if(backButtonPress > 1) {
							plus.runtime.quit();
						} else {
							plus.nativeUI.toast('再按一次退出应用');
						}
						setTimeout(function() {
							backButtonPress = 0;
						}, 1000);
						return false;
					};
					//----------end: 按键事件----------------
				});
			}(mui, document));
		</script>
	</body>

</html>